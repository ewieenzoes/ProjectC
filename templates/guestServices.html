<script src="https://unpkg.com/htmx.org@1.6.1"></script>
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Project C | Uni Siegen</title>
    {% block css %}
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bulma@0.9.3/css/bulma.min.css">
        <script src="//unpkg.com/alpinejs" defer></script>
        <style>
            [x-cloak] {
                display: none !important;
            }

            .select2-container {

                display: block !important;

            }
        </style>
        {% block extra_css %}

        {% endblock extra_css %}
    {% endblock css %}
</head>
<body hx-headers='{"X-CSRFToken": "{{ csrf_token }}"}'>

<div class="container mt-5 ml-5">
    <h2 class="title is-4">Ihr Verzehr</h2>

    <table class="table">
        <thead>
        <tr>
            <th>Speisen/Getränke</th>
            <th>Preis</th>
        </tr>
        </thead>
        <tbody>
            {% for i in dashboardTemplateData %}
                <tr>
                    <td>{{ i }}</td>
                    <td>{{ i.price }}€</td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <div x-data="{ service: false, payment:false }">
        <div class="modal is-active" x-show="service" x-cloak>
            <div class="modal-background"></div>
            <div class="modal-content">
                <!-- Any other Bulma elements you want -->
                <div class="card">
                    <div class="card-content">
                        <div class="content">
                            <h4 class="title is-4">Wir sind gleich für Sie da.</h4>
                            <p>Der Service wurde infomiert und kommt zu Ihrem Platz.</p>
                        </div>
                    </div>
                    <footer class="modal-card-foot">
                        <button class="button is-success" @click="service = false">Ok!</button>
                    </footer>
                </div>
            </div>
            <button class="modal-close is-large" aria-label="close"></button>
        </div>
        <div class="modal is-active" x-show="payment" x-cloak>
            <div class="modal-background"></div>
            <div class="modal-content">
                <!-- Any other Bulma elements you want -->
                <div class="card">
                    <div class="card-content">
                        <div class="content">
                            <h4 class="title is-4">Wie möchten Sie bezahlen?</h4>
                            <div id="innerBox">
                                <button class="button is-light" hx-post="/gs/requestPayment/{{ coasterId }}/Bar/"  hx-target="#innerBox">Bar-Zahlung</button>
                                <button class="button is-light" hx-post="/gs/requestPayment/{{ coasterId }}/Karte/" hx-target="#innerBox">Karten-Zahlung</button>
                            </div>
                        </div>
                    </div>
                    <footer class="modal-card-foot">
                        <button class="button is-danger" @click="payment = false">Schließen</button>
                    </footer>
                </div>
            </div>
            <button class="modal-close is-large" aria-label="close"></button>
        </div>
        <h2 class="title is-4">Weitere Optionen</h2>
        <button class="button is-light" @click="payment = true">Bezahl-Wunsch</button>
        <button class="button is-dark" @click="service = true" hx-post="/gs/callService/{{ coasterId }}/" hx-swap="outerHTML">Service</button>
    </div>
</div>


<script src="https://unpkg.com/htmx.org@1.6.1"></script>
<script src="https://code.jquery.com/jquery-3.6.0.slim.min.js"
        integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
<link href="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/css/select2.min.css" rel="stylesheet"/>
<script src="https://cdn.jsdelivr.net/npm/select2@4.1.0-rc.0/dist/js/select2.min.js"></script>

<script>
    $(document).ready(function () {
        $('.js-example-basic-multiple').select2();
    });
</script>
<script>
    async function postBev(tableId, coasterId, bevName, bevEdit) {
        let response = await fetch('/table/' + tableId + '/coaster/' + coasterId + '/new/' + bevName + '/' + bevEdit)
        if (response.ok) { // if HTTP-status is 200-299

            let event = new Event("bevsuccess");
            dispatchEvent(event);
            setTimeout(function () {
                let event_2 = new Event("bevover");
                dispatchEvent(event_2);
            }, 2000);


        } else {
            alert("HTTP-Error: " + response.status);
        }
    }
</script>

</body>
</html>